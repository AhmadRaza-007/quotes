i # API Key Authentication System

This document explains how to use the API key authentication system to secure your API endpoints.

## Overview

The API now requires API key authentication for most endpoints. API keys can be generated by authenticated users and must be included in API requests.

## Authentication Methods

You can provide the API key in one of two ways:

### 1. HTTP Header (Recommended)
```http
X-API-Key: your_api_key_here
```

### 2. Query Parameter
```http
GET /api/endpoint?api_key=your_api_key_here
```

## API Key Management Endpoints

All API key management endpoints require user authentication (JWT token).

### Generate a New API Key
```http
POST /api/api-keys
Content-Type: application/json
Authorization: Bearer {jwt_token}

{
    "name": "My App",
    "expires_in_days": 30  // Optional: Key will expire in 30 days
}
```

Response:
```json
{
    "success": true,
    "message": "API key generated successfully",
    "data": {
        "id": 1,
        "name": "My App",
        "key": "generated_api_key_string",
        "expires_at": "2024-11-10T10:30:00.000000Z",
        "created_at": "2024-10-10T10:30:00.000000Z"
    }
}
```

**Important**: Save the `key` value immediately as it will not be shown again!

### List API Keys
```http
GET /api/api-keys
Authorization: Bearer {jwt_token}
```

### Get API Key Details
```http
GET /api/api-keys/{id}
Authorization: Bearer {jwt_token}
```

### Update API Key
```http
PUT /api/api-keys/{id}
Content-Type: application/json
Authorization: Bearer {jwt_token}

{
    "name": "Updated Name",
    "is_active": false
}
```

### Delete API Key
```http
DELETE /api/api-keys/{id}
Authorization: Bearer {jwt_token}
```

### Regenerate API Key
```http
POST /api/api-keys/{id}/regenerate
Authorization: Bearer {jwt_token}
```

## Endpoint Security

### Public Endpoints (No API Key Required)
- `POST /api/login`
- `POST /api/signup`
- `POST /api/forget-password`
- `POST /api/reset-password`
- `POST /api/change-password`
- `POST /api/auth/google`
- `POST /api/auth/facebook`
- `GET /api/wallpapers`
- `GET /api/wallpapers/{id}`

### API Key Protected Endpoints
All other endpoints require a valid API key, including:
- User profile endpoints
- Category endpoints
- Follow system endpoints
- Like/Favorite/Comment endpoints

### User Authentication Required Endpoints
- API key management endpoints
- User logout
- Profile management
- Wallpaper upload/management (admin)

## Error Responses

### Missing API Key
```json
{
    "error": "API key required",
    "message": "Please provide a valid API key in the X-API-Key header or api_key query parameter"
}
```

### Invalid API Key
```json
{
    "error": "Invalid API key",
    "message": "The provided API key is invalid or expired"
}
```

## Best Practices

1. **Store API keys securely** - Never commit them to version control
2. **Use HTTP headers** - Prefer headers over query parameters for better security
3. **Rotate keys regularly** - Regenerate keys periodically
4. **Set expiration dates** - Use the `expires_in_days` parameter when generating keys
5. **Monitor usage** - Check the `last_used_at` field to monitor key activity

## Example Usage

### JavaScript/Fetch
```javascript
const apiKey = 'your_api_key_here';

// Using header
const response = await fetch('/api/users/123', {
    headers: {
        'X-API-Key': apiKey
    }
});

// Using query parameter
const response = await fetch(`/api/users/123?api_key=${apiKey}`);
```

### cURL
```bash
# Using header
curl -H "X-API-Key: your_api_key_here" https://yourdomain.com/api/users/123

# Using query parameter
curl "https://yourdomain.com/api/users/123?api_key=your_api_key_here"
```


